# -*- coding: utf-8 -*-
"""Mental_health_treatment_prediction .ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ashYKd24g8yIkrgLMeUPESz0-eyJpfM5
"""

!pip install scikit-learn pandas numpy matplotlib seaborn

# imports
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.preprocessing import LabelEncoder
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

# check what file exit
!ls

# Unzip file
!unzip archive\ \(6\).zip

!ls

# load dataset
df = pd.read_csv("/content/Mental Health Dataset.csv")

df.head()

# Basic data inspection
print("Shape:", df.shape)

print("\nColumns:\n", df.columns)

print("\nInfo:")
df.info()

# Drop Irrelevant column
#Timestamp is not useful for prediction
df = df.drop(columns=["Timestamp"])

# Handling Missing Values
df = df.dropna()

# Encode Categorical columns
le = LabelEncoder()
for  col in df.columns:
  df[col] = le.fit_transform(df[col])

# Split Features and target
# Target column :treatment
X = df.drop('treatment', axis = 1)
y = df['treatment']

# Train test split
X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size = 0.2,
    random_state = 42
)

# Train Random forest model
model = RandomForestClassifier(
    n_estimators = 100,
    random_state = 42
)
model.fit(X_train, y_train)

# Model Evaluation
y_pred = model.predict(X_test)
print("Accuracy:", accuracy_score(y_test, y_pred))
print("classification_report:\n")
print(classification_report(y_test, y_pred))

# confusion matrix
cm = confusion_matrix(y_test, y_pred)

plt.figure()
sns.heatmap(cm, annot = True, fmt='d')
plt.title("Confusion Matrix")
plt.ylabel("Actual")
plt.xlabel("Predicted")
plt.show()

# Feature Importance
importance = pd.Series(
    model.feature_importances_,
    index = X.columns
).sort_values(ascending = False)

print("Top 10 important Features:\n")
print(importance.head(10))

importance.head(10).plot(kind ='bar')
plt.title(" Top Features Influencing Mental Health Treatment")
plt.ylabel("Importance Score ")
plt.show()

# Sample prediction
sample = X.iloc[0].values.reshape(1, -1)
prediction = model.predict(sample)

print("Prediction ( 1 = needs Treatment , 0 = No Treatment):", prediction[0])

